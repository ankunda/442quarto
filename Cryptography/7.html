<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2025-03-24">

<title>Cryptography</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="7_files/libs/clipboard/clipboard.min.js"></script>
<script src="7_files/libs/quarto-html/quarto.js"></script>
<script src="7_files/libs/quarto-html/popper.min.js"></script>
<script src="7_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="7_files/libs/quarto-html/anchor.min.js"></script>
<link href="7_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="7_files/libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="7_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="7_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="7_files/libs/bootstrap/bootstrap-c40a5ba31462359f55d4ba59e7a4ff32.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<style>

      .quarto-title-block .quarto-title-banner {
        background: #002f8b;
      }
</style>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body>

<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Cryptography</h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">March 24, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a></li>
  <li><a href="#history" id="toc-history" class="nav-link" data-scroll-target="#history"><span class="header-section-number">2</span> History</a>
  <ul class="collapse">
  <li><a href="#hieroglyph" id="toc-hieroglyph" class="nav-link" data-scroll-target="#hieroglyph"><span class="header-section-number">2.1</span> Hieroglyph</a></li>
  <li><a href="#atbash-cipher" id="toc-atbash-cipher" class="nav-link" data-scroll-target="#atbash-cipher"><span class="header-section-number">2.2</span> Atbash cipher</a></li>
  <li><a href="#scytale-cipher" id="toc-scytale-cipher" class="nav-link" data-scroll-target="#scytale-cipher"><span class="header-section-number">2.3</span> Scytale cipher</a></li>
  <li><a href="#caesar-cipher" id="toc-caesar-cipher" class="nav-link" data-scroll-target="#caesar-cipher"><span class="header-section-number">2.4</span> Caesar cipher</a></li>
  <li><a href="#sliding-shift-cipher" id="toc-sliding-shift-cipher" class="nav-link" data-scroll-target="#sliding-shift-cipher"><span class="header-section-number">2.5</span> Sliding shift cipher</a></li>
  <li><a href="#vigenere-cipher" id="toc-vigenere-cipher" class="nav-link" data-scroll-target="#vigenere-cipher"><span class="header-section-number">2.6</span> Vigenere cipher</a>
  <ul class="collapse">
  <li><a href="#why-use-manual-when-we-have-computers" id="toc-why-use-manual-when-we-have-computers" class="nav-link" data-scroll-target="#why-use-manual-when-we-have-computers"><span class="header-section-number">2.6.1</span> Why use manual when we have computers?</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#encoding" id="toc-encoding" class="nav-link" data-scroll-target="#encoding"><span class="header-section-number">3</span> Encoding</a></li>
  <li><a href="#cryptography-today" id="toc-cryptography-today" class="nav-link" data-scroll-target="#cryptography-today"><span class="header-section-number">4</span> Cryptography today</a>
  <ul class="collapse">
  <li><a href="#symmetric-key-cryptography" id="toc-symmetric-key-cryptography" class="nav-link" data-scroll-target="#symmetric-key-cryptography"><span class="header-section-number">4.1</span> Symmetric-key Cryptography</a></li>
  <li><a href="#asymmetric-cryptography" id="toc-asymmetric-cryptography" class="nav-link" data-scroll-target="#asymmetric-cryptography"><span class="header-section-number">4.2</span> Asymmetric Cryptography</a></li>
  <li><a href="#hashing" id="toc-hashing" class="nav-link" data-scroll-target="#hashing"><span class="header-section-number">4.3</span> Hashing</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="introduction" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction</h1>
<p>Cryptography has always been about message confidentiality i.e.&nbsp;making sure that a message can only be understood by the sender and/or its intended recipient. It typically involves converting a message into an incomprehensible format and then that process being reversed by the recipient. A good cryptography system should leave a potential eavesdropper with a sense of helplessness i.e.&nbsp;they should feel like they don’t have the time or energy to figure out what the message is. Of course the standard for “time or energy” has changed drastically with computers and what seemed like a lot of time or energy doesn’t seem like a lot if you have a computer and know how to write a few scripts. However, computers also allow us to create even more complicated encryption systems. Another thing to consider is that even with computers, there are categories of problems or algorithms that are difficult for a computer to solve. Recall how complex it was to solve a towers of hanoi problem (from CSC 220 and CSC/CYEN 131) even when the algorithm was very simple to write/understand. A good cryptography system might be easy to understand (i.e.&nbsp;how it works), but should still leave us (and our computers) feeling like there isn’t enough time/RAM to figure out the original message.</p>
<p>Definitions:</p>
<ul>
<li><strong>cryptology</strong>: enciphering and deciphering</li>
<li><strong>cryptography</strong>: making a cipher system</li>
<li><strong>cryptanalysis</strong>: breaking a cipher system</li>
<li><strong>encryption</strong>: scrambling a message</li>
<li><strong>decryption</strong>: unscrambling a message</li>
<li><strong>plain text</strong>: original “readable” message</li>
<li><strong>cipher text</strong>: encrypted “unreadable” message</li>
<li><strong>cipher</strong>: algorithm for performing encryption or decryption</li>
</ul>
</section>
<section id="history" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> History</h1>
<p>Classic cryptography used pen, paper and perhaps simple mechanical aids. As we discuss them, try and see if you can figure out how we would break the cipher and how complicated it might be given current technology i.e. current definitions of “time and energy”. The highlighted encrypted messages are for you to try and decrypt.</p>
<section id="hieroglyph" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="hieroglyph"><span class="header-section-number">2.1</span> Hieroglyph</h2>
<p>This was used from around 3200BC to about 400AD. Utilized images or symbols to represent messages that could only be interpreted by those who knew what the symbols meant. Of course this is no different from writing in a language. The more people know that language, the less effective it is at keeping messages secret.</p>
</section>
<section id="atbash-cipher" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="atbash-cipher"><span class="header-section-number">2.2</span> Atbash cipher</h2>
<p>This was used from about 500BC to 1300AD. Its a type of substitution cipher where the order of the alphabet is reversed i.e.&nbsp;A becomes Z, B becomes Y, etc. Examples of it can actually be found in the bible <a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>.</p>
<p style="text-align:center;">
<span style="background-color: #FFFF00">rhm’g xibkgltizksb ufm?</span>
</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>$ echo {z..a} | tr -d ' ' # to create the character set z through a.</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>$ echo "abcde" | tr a-z "zyxwvutsrqponmlkjihgfedcba"</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="scytale-cipher" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="scytale-cipher"><span class="header-section-number">2.3</span> Scytale cipher</h2>
<p>This was used around 7th century BC. Messages were written on strip of parchment wrapped round a rod. When strip was unwrapped, the message was unreadable unless it was re-wrapped around a rod of similar dimensions.</p>
<p style="text-align:center;">
<span style="background-color: #FFFF00">Sdeeeiootyrdnnmhdbwgzeareatostaithoattncimihhbhs</span>
</p>
</section>
<section id="caesar-cipher" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="caesar-cipher"><span class="header-section-number">2.4</span> Caesar cipher</h2>
<p>Also a substitution cipher. Named after the first famous person to use this technique. It typically involves replacing a character with another character in the same character set but identified by shifting the alphabet over by a specific number of positions. Caesar used to replace A with D, B with E, C with F, …, X with an A, Y with a B, and Z with a C. Because the alphabet was rotated by 3 positions, this specific version can be called a rot-3 cipher. One of the most common Caesar ciphers is the rot-13 because the alphabet is reflected i.e.&nbsp;it is it’s own inverse.</p>
<p style="text-align:center;">
<span style="background-color: #FFFF00">diwtgh hpxs: durdjght xi xh</span>
</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>$ echo "abcde" | tr a-z d-za-c #rot-3</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>$ echo "abcde" | tr a-z n-za-m #rot-13</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="sliding-shift-cipher" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="sliding-shift-cipher"><span class="header-section-number">2.5</span> Sliding shift cipher</h2>
<p>The issue with Caesar is that it is easy to break these days. You only need to look at 25 different possibilities to decipher it visually. A sliding shift cipher attempts to make this more difficult by employing a different shift for each position in the plain text string. For example, the first letter is encoded using rot-1, second letter using rot-2, third letter using rot-3, etc. One doesn’t have to start at 1, but the increase size is typically 1. However, If I know that the cipher is the sliding shift cipher, breaking it is not that hard.</p>
</section>
<section id="vigenere-cipher" class="level2" data-number="2.6">
<h2 data-number="2.6" class="anchored" data-anchor-id="vigenere-cipher"><span class="header-section-number">2.6</span> Vigenere cipher</h2>
<p>This was used from about 1553-1863. Each letter of the plain text was encoded by rotating the alphabet based on a key or passphrase. For example, if the key was “key”, then the first letter would be gotten from a rot-10 alphabet i.e.&nbsp;where a became k, b became l, c became m, etc. The second letter would be gotten from a rot-4 alphabet i.e.&nbsp;where a became e, b became f, c became g, etc. The key would be repeated as many times as necessary to encode the entire plain text. A cipher disk or vigenere table (such as the one shown below) can be used for manual encryption/decryption. For example, the plain text “how does this work” can be encrypted using the key “vigenere”.</p>
<table class="table-bordered caption-top table">
<caption>Using the Vigenere Cipher</caption>
<colgroup>
<col style="width: 22%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th>Plain text</th>
<th>H</th>
<th>O</th>
<th>W</th>
<th>D</th>
<th>O</th>
<th>E</th>
<th>S</th>
<th>T</th>
<th>H</th>
<th>I</th>
<th>S</th>
<th>W</th>
<th>O</th>
<th>R</th>
<th>K</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Key</td>
<td>V</td>
<td>I</td>
<td>G</td>
<td>E</td>
<td>N</td>
<td>E</td>
<td>R</td>
<td>E</td>
<td>V</td>
<td>I</td>
<td>G</td>
<td>E</td>
<td>N</td>
<td>E</td>
<td>R</td>
</tr>
<tr class="even">
<td>Cipher text</td>
<td>C</td>
<td>W</td>
<td>C</td>
<td>H</td>
<td>B</td>
<td>I</td>
<td>J</td>
<td>X</td>
<td>C</td>
<td>Q</td>
<td>Y</td>
<td>A</td>
<td>B</td>
<td>V</td>
<td>B</td>
</tr>
</tbody>
</table>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Plain-key.png" class="img-fluid figure-img"></p>
<figcaption>Vigenere Chart</figcaption>
</figure>
</div>
<p>In the table above, the column headers is the <em>plain text</em>, and the row headers is the <em>key</em>, and where the corresponding column and row intersect is the <em>cipher text</em>. To <span style="background-color:
#ff9e00">encrypt</span> a plain text character <strong>l</strong> and key character <strong>n</strong>, identify where the column l and row n intersect which is <strong>y</strong>.</p>
<p>To <span style="background-color: #fff100">decrypt</span>, identify the <em>cipher</em> character on the appropriate <em>key</em> row, and then match it to the corresponding column header. For example, the cipher character <strong>p</strong> with the key character <strong>x</strong> becomes the plain text character <strong>s</strong>.</p>
<section id="why-use-manual-when-we-have-computers" class="level3" data-number="2.6.1">
<h3 data-number="2.6.1" class="anchored" data-anchor-id="why-use-manual-when-we-have-computers"><span class="header-section-number">2.6.1</span> Why use manual when we have computers?</h3>
<p>To take advantage of the computational power now available to us, however, it is significantly easier/faster if we use math.</p>
<p><img src="1.png" class="img-fluid"></p>
<p>If we map each character of the plain text and cipher text to a number (e.g.&nbsp;the number shown in the table above), then the rotation (or look up in the vigenere square) is essentially the same as adding those two numbers and looking up the corresponding letter.</p>
<p>For example we see that plain text character l has a value of 11 and key character n has a value of 13. The sum of those two numbers is 24 which maps to y. This is an identical result to what we saw with the vigenere square. If the sum of the two numbers is more than 25, then we wrap around and continue from the beginning i.e.&nbsp;% 26.</p>
<p>Decrypting is just a matter of doing the reverse i.e.&nbsp;subtract the numerical value of the key character from the numerical value of the cipher text character to get the numerical value of the plain text character. Make sure to wrap around if this difference is negative.</p>
<p>More formally, if <span class="math inline">\(P\)</span> is the plain text, <span class="math inline">\(K\)</span> the key, <span class="math inline">\(C\)</span> the cipher text, and the subscript <span class="math inline">\(i\)</span> the character in the i<sup>th</sup> position of any of those three, then.</p>
<p><span class="math display">\[C_i=(P_i+K_i)\%26\]</span></p>
<p>To decrypt.</p>
<p><span class="math display">\[P_i=(26+C_i-K_i)\%26\]</span></p>
<p>The 26 is added just to make the math of the wrap around consistent across different programming languages. Some languages give different results for the modulo of a negative number.</p>
<p>As an example, if our text is “cyberstorm is going to be bussin” and our key is “cryptids”</p>
<p><span class="math display">\[
P_0 = c, K_0 = c → C_0 = (2+2)\%26 = 4 = e \\
\]</span></p>
<p><span class="math display">\[
P_1 = y, K_1 = r → C_1 = (24+17)\%26 = 15 = p
\]</span></p>
<p><span class="math display">\[
P_2 = b, K_2 = y → C_2 = (1+24)\%26 = 25 = z
\]</span></p>
<p><span class="math display">\[
P_3 = e, K_3 = p → C_3 = (4+15)\%26 = 19 = t
\]</span></p>
<p><span class="math display">\[
P_4 = r, K_4 = t → C_4 = (17+19)\%26 = 10 = k
\]</span></p>
<p><span class="math display">\[
P_5 = s, K_5 = i → C_5 = (18+8)\%26 = 0 = a
\]</span></p>
<p><span class="math display">\[
P_6 = t, K_6 = d → C_6 = (19+3)\%26 = 22 = w
\]</span></p>
<p><span class="math display">\[
...
\]</span></p>
<p>CipherText = <strong>epztkawgtd gh zwlfi km qx jxkuzl</strong></p>
<p>If you wanted to decrypt “<em>avq nhcu htfdtlarj wjcs ucvkke. Ft’l maltr. Ld vis.</em>” using the same key</p>
<p><span class="math display">\[
C_0 = a, K_0 = c → P_0 = (26+0-2)\%26 = 24 = y
\]</span></p>
<p><span class="math display">\[
C_1 = v, K_1 = r → P_1 = (26+21-17)\%26 = 4 = e
\]</span></p>
<p><span class="math display">\[
C_2 = q, K_2 = y → P_2 = (26+16-24)\%26 = 18 = s
\]</span></p>
<p><span class="math display">\[
C_3 = n, K_3 = p → P_3 = (26+13-15)\%26 = 24 = y
\]</span></p>
<p><span class="math display">\[
C_4 = h, K_4 = t → P_4 = (26+7-19)\%26 = 14 = o
\]</span></p>
<p><span class="math display">\[
C_5 = c, K_5 = i → P_5 = (26+2-8)\%26 = 20 = u
\]</span></p>
<p><span class="math display">\[
C_6 = u, K_6 = d → P_6 = (26+20-3)\%26 = 17 = r
\]</span></p>
<p><span class="math display">\[
…
\]</span></p>
<p>Plain text = <strong>yes your …</strong></p>
<p>Since many programming languages actually store characters as integers, getting the numerical value of the character from the table above is often as simple as subtracting the integer value of ‘A’ or ‘a’.</p>
<p>In c++ for example, ‘P’ - ‘A’ = 80 – 65 = 15.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>Historically speaking, cryptography was almost always concerned with hiding written language text. Computers have changed the game in three ways</p>
<ul>
<li><p>They do things faster and so allow us to decrypt cipher text messages faster</p></li>
<li><p>They also allow us to come up with more complex ciphers i.e.&nbsp;ciphers that would be too complicated to carry out by hand in a realistic time frame</p></li>
<li><p>They allow us to encrypt any kind of data that can be represented by 1s and 0s. ANYTHING. Not just text but any kind of digital file. One could argue this is the main change that computers brought to the cryptography field.</p></li>
</ul>
</div>
</div>
</section>
</section>
</section>
<section id="encoding" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Encoding</h1>
<p>Cryptography is not only about hiding information. Sometimes its just about representing information in a manner that is convenient to work with. For example, since computers only deal with 1s and 0s, we have encoding schemes to represent information like characters in 1s and 0s.</p>
<p>The most common encoding format is <strong>ASCII</strong> (American Standard Code for Information Interchange) which is based on the English alphabet. Its original format only required 7 bits to represent any thing that might be represented i.e.&nbsp;numbers, lower case and upper case letters, punctuation, and control characters (which were non-printable).</p>
<p>Later as 8 bit storage became the norm, ASCII was extended to 8 bits which allowed for double the encodings.</p>
<p>Common conversions are</p>
<p>A = 65 = 01000001, B = 66 = 01000010, a = 97 = 01100001, b = 98 = 01100010</p>
<p>Another common encoding scheme is base-64. This particular scheme was birthed from a need to send any kind of binary information (such as attachments in en email) along a channel that only carried text. One way to identify this scheme is that the file will be made up entirely of characters, numbers and two signs e.g.&nbsp;<strong>+</strong> and <strong>/</strong>. Some files will also end with one or more <strong>=</strong> signs.</p>
<p>The process of converting any binary stream to base-64 is similar to the conversion from binary to hexadecimal you covered in CSC/CYEN 131 i.e. group the bits, and then look up the mapping for that group (or the mapping for the numerical value of that group). It should not come as a surprise that for base 64, we shall be looking at groupings of 6 bits. <span class="math inline">\((2^6 = 64)\)</span></p>
<table class="table-bordered table-striped table-hover caption-top table">
<caption>Standard Base64 conversion table</caption>
<thead>
<tr class="header">
<th>Value</th>
<th>Char</th>
<th>Value</th>
<th>Char</th>
<th>Value</th>
<th>Char</th>
<th>Value</th>
<th>Char</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>A</td>
<td>16</td>
<td>Q</td>
<td>32</td>
<td>g</td>
<td>48</td>
<td>w</td>
</tr>
<tr class="even">
<td>1</td>
<td>B</td>
<td>17</td>
<td>R</td>
<td>33</td>
<td>h</td>
<td>49</td>
<td>x</td>
</tr>
<tr class="odd">
<td>2</td>
<td>C</td>
<td>18</td>
<td>S</td>
<td>34</td>
<td>i</td>
<td>50</td>
<td>y</td>
</tr>
<tr class="even">
<td>3</td>
<td>D</td>
<td>19</td>
<td>T</td>
<td>35</td>
<td>j</td>
<td>51</td>
<td>z</td>
</tr>
<tr class="odd">
<td>4</td>
<td>E</td>
<td>20</td>
<td>U</td>
<td>36</td>
<td>k</td>
<td>52</td>
<td>0</td>
</tr>
<tr class="even">
<td>5</td>
<td>F</td>
<td>21</td>
<td>V</td>
<td>37</td>
<td>l</td>
<td>53</td>
<td>1</td>
</tr>
<tr class="odd">
<td>6</td>
<td>G</td>
<td>22</td>
<td>W</td>
<td>38</td>
<td>m</td>
<td>54</td>
<td>2</td>
</tr>
<tr class="even">
<td>7</td>
<td>H</td>
<td>23</td>
<td>X</td>
<td>39</td>
<td>n</td>
<td>55</td>
<td>3</td>
</tr>
<tr class="odd">
<td>8</td>
<td>I</td>
<td>24</td>
<td>Y</td>
<td>40</td>
<td>o</td>
<td>56</td>
<td>4</td>
</tr>
<tr class="even">
<td>9</td>
<td>J</td>
<td>25</td>
<td>Z</td>
<td>41</td>
<td>p</td>
<td>57</td>
<td>5</td>
</tr>
<tr class="odd">
<td>10</td>
<td>K</td>
<td>26</td>
<td>a</td>
<td>42</td>
<td>q</td>
<td>58</td>
<td>6</td>
</tr>
<tr class="even">
<td>11</td>
<td>L</td>
<td>27</td>
<td>b</td>
<td>43</td>
<td>r</td>
<td>59</td>
<td>7</td>
</tr>
<tr class="odd">
<td>12</td>
<td>M</td>
<td>28</td>
<td>c</td>
<td>44</td>
<td>s</td>
<td>60</td>
<td>8</td>
</tr>
<tr class="even">
<td>13</td>
<td>N</td>
<td>29</td>
<td>d</td>
<td>45</td>
<td>t</td>
<td>61</td>
<td>9</td>
</tr>
<tr class="odd">
<td>14</td>
<td>O</td>
<td>30</td>
<td>e</td>
<td>46</td>
<td>u</td>
<td>62</td>
<td>+</td>
</tr>
<tr class="even">
<td>15</td>
<td>P</td>
<td>31</td>
<td>f</td>
<td>47</td>
<td>v</td>
<td>63</td>
<td>/</td>
</tr>
</tbody>
</table>
<p>To demonstrate this conversion, we shall start with text as represented using ASCII. Even though we are using text to begin with, this technique can be used with any digital file since all digital files are made up of 1s and 0s.<br>
<br>
Let’s say we want to convert the string “abc” from ascii to base-64.</p>
<p><img src="b64_1.png" class="img-fluid"></p>
<p>Which means it would be encoded as <em>YWJj</em>.</p>
<p>The original bits (which in this case were gotten by encoding the characters in 8-bit ASCII) are placed next to each other, grouped in 6s, and then each of those groups is converted back to a decimal number and looked up in the base-64 table.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>$ echo -n "abc" | base64 # -n is to remove the newline character</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Notice, however, that 8 bits for 3 characters sums up to 24 bits, which is a perfect multiple of 6 (the group size) so every bit is converted accurately. That is not always the case. If the number of bits of the original message is not a perfect multiple of 8, then we have to pad the original message until we get to a number of bits that is a multiple of both 6 and 8 (8 bits because we’re using 8-bit ascii)</p>
<p>As an example, let’s say we wanted to convert the string “x”</p>
<p><img src="b64_2.png" class="img-fluid"></p>
<p>The first 6 bits make sense: they convert to 30 which maps to “e”. The next two bits are part of the original message and require 4 padded bits. They convert to a 0 which maps to “A”. The next 12 bits, however, are made up entirely of bits that were added just for padding. To convert them directly to base-64 would be erroneous since there were not part of the original message. Therefore they are mapped to the symbol “=” which you will notice was not part of the original base-64 character set. Seeing a “=” symbol at the end of a base-64 conversion is a way to tell that padding was done and therefore one would not consider those extra bits when converting back from base-64.</p>
<p>Let’s try another example in which we convert the string “CS” to base-64.</p>
<p><img src="b64_3.png" class="img-fluid"></p>
<p>We see it converts to Q1M= in base-64.</p>
<p>What about going backwards i.e.&nbsp;from base-64 to ASCII? We shall try “RU4=”</p>
<p><img src="b64_4.png" class="img-fluid"></p>
<p>We see it converts to “EN”</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>$ echo -n "RU4=" | base64 -d # -d is to decode base-64</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="cryptography-today" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Cryptography today</h1>
<p>The Internet created a need for an even more secure cryptography. We now all use a system over which no single entity has complete power and bad actors can easily get access to the information you are sending to or receiving from someone else. Additionally we also need ways of confirming that the person we are communicating with is in fact the person we intended to communicate with, or the file we requested is in fact the file we received. All these issues/problems leverage modern cryptography in some form.</p>
<section id="symmetric-key-cryptography" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="symmetric-key-cryptography"><span class="header-section-number">4.1</span> Symmetric-key Cryptography</h2>
<p><strong>Symmetric-key cryptography</strong> works like most of the classic cryptography approaches we discussed earlier i.e.&nbsp;both sender and receiver need to share the key in order to encrypt and decrypt the message. Depending on the algorithm, the input stream can be encrypted as it is experienced (stream ciphers) i.e.&nbsp;a byte or letter at a time OR it can encrypt them in blocks of bits with each block encrypted as a single unit (block ciphers).</p>
<p>Examples of algorithms in this category include AES, 3DES, Serpent, Twofish, Blowfish</p>
<p>This is typically a fast cryptography approach. The only issue is that it is based on the assumption that the two people trying to communicate were able to share a key privately. Doing so requires a private channel and yet we’re trying to set up a private channel. Many times this is not possible for one reason or another e.g.&nbsp;physical separation.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="2.png" class="img-fluid figure-img"></p>
<figcaption>Symmetric-key Cryptography</figcaption>
</figure>
</div>
</section>
<section id="asymmetric-cryptography" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="asymmetric-cryptography"><span class="header-section-number">4.2</span> Asymmetric Cryptography</h2>
<p><strong>Asymmetric cryptography</strong> is relatively newer and uses the idea of two keys. The two keys are linked in such a way that any message encrypted with one of them requires the second to be decrypted. Another characteristic of the keys is that you can not design (or guess) one of them from the other. This second characteristic is the whole crux of the system. One of the more common ways of guaranteeing that is the use of prime numbers/factors. It takes very long to identify whether a number is prime, and it takes even longer to identify the prime factors of a number (particularly a very large number). The process of encryption/decryption is therefore slightly different. The person who wants to send a message encrypts it with one key, and the person who wants to decrypt it uses the other key. The first key is called the public key because you provide that key to everyone and anyone. You do this so that anyone who wants to send you a message can be sure that you are the only person who can open it since you are the only person who has the other key (aptly called the private key)</p>
<p><img src="3.png" class="img-fluid"></p>
<p>There are two major advantages of this approach. First is that we don’t have to have met for you to communicate with me and know that our communication is private. There are servers dedicated to storing people’s public keys, people attach them to emails, etc. So if you want to communicate with me, all I have to have done is have published my public key somewhere.</p>
<p>The second advantage is that this technique allows us to solve the problem of confirming the identity of someone if the encryption/decryption process is reversed. Person A uses their private key to encrypt a broadcast message. Anyone who has access to their public key (which everyone does) can now use that key to decrypt the message. It might be weird because it is not a secret message and anyone can decrypt it but the cool thing about it is that we all know that no-one else could have created that message in the first place since only you have the private key. In that regard, the public/private key approach allows us to have digital signatures which help us to determine the authenticity of a message. It allows us to answer questions like “is this message from a trusted source?” and “has this message been changed in transit by someone pretending to be the trusted source?”.</p>
<p>Examples of the public/private key systems include Diffie-Helman, RSA, DSA (Digital Signature algorithm), ECDSA (Eliptical curve DSA). You can find some of these details in the certificate details of your web browser.</p>
</section>
<section id="hashing" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="hashing"><span class="header-section-number">4.3</span> Hashing</h2>
<p><strong>Hashing</strong> is another way cryptography is used today. Recall from CSC 220 that hashing is a central part of how hash tables work. For hash tables, hashing converted a key of any length/type into a valid index in the table where the value would be stored. Outside of hash tables, hashing is used to translate data of any size into a unique fixed size string output. Any good hashing function works in such a way that this process cannot be reversed. At first glance, this seems counter productive i.e. why scramble up a long message into a short string of gibberish if I cannot unscramble that gibberish back to get the message? The reason is that a good hash function will scramble any message into a unique string of gibberish. I’ll give you two examples of where this functionality is actually helpful.</p>
<p>Imagine you downloaded an ISO file for Linux Mint and it took 2 hours to download on your home internet (in fact imagine how long it would take on the slow internet we had not that long ago). It would be very painful if you took a full day installing the operating system only to realise that the ISO file was corrupted in some way during the download and you’ll have to start the whole download and install process again with the hope that it doesn’t happen again. What many servers that store large files will do is provide a hash of that file. That way once you have downloaded the file, you can run it through the hash function, a process which takes a very short time, and confirm if the hash you got is identical to the hash that the server said you should get. If so, then your file was not corrupted. If not, then you need to re-download and not waste your time installing the corrupted file.</p>
<p>Another place that hashing is used is in the storage of passwords. Given that bad actors can easily get access to systems, it would be bad if they got access to every password that was ever used on that system in plain text. What most servers/systems will do is actually store a hash of your password instead. That way there is no way the bad actors can get your passwords. They just get the hashes and there is no way to get the passwords when you have the hash. The only thing they can do is run a bunch of passwords they know of through the hashing function and hope that one of them hashes to the exact same thing as your hash. And if that happens then they have figured out your password. There are ways to deal with this but they are beyond our discussion right now.</p>
<p>There are multiple hashing functions being used these days. These hash functions are typically evaluated based on the number of collisions they have (which should be very low), and how difficult they are to reverse (which should be impossible).</p>
<p>MD5 (Message Digest algorithm 5) converts large data into a string of 128 bits. As early as 1993 researchers found vulnerabilities in it (such as collisions) and so it isn’t used much for high security cryptography but rather for checksums to verify data.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>$ echo -n "hello world" | md5sum # any small difference in input</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>$ echo “hello world” | md5sum # should produce a very different hash</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>SHA – Secure Hash Algorithms – is a family of hashing functions. SHA1 is similar to MD5 and was pretty much abandoned as of 2010. SHA 256 and SHA 512 are probably some of the more common ones and are named after the length in bits of the output they produce.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>$ echo -n "hello world" | sha1sum</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>$ echo -n “hello world” | sha256sum</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>$ echo -n “hello world” | sha512sum</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This has been a lot of information but hopefully it is very intriguing information. Some of these topics we shall cover in more detail later in the quarter with more application. Others you’ll just have to wait till you see them in classes like CSC 444/544/CYEN 406 <a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>.</p>
</section>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>(https://www.theology.ox.ac.uk/article/crack-the-code)<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Typically offered every other year in the Spring quarter. Was last offered in Spring 2024.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>